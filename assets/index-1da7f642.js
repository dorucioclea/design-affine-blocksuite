import{r as a}from"./index-76fb7be0.js";import{r as A}from"./index-d3ea75b5.js";import{a as h,b as p,c as v}from"./index-7f39a493.js";function E(e,o){return a.useReducer((c,t)=>{const r=o[c][t];return r??c},e)}const P=e=>{const{present:o,children:c}=e,t=b(o),r=typeof c=="function"?c({present:t.isPresent}):a.Children.only(c),s=h(t.ref,r.ref);return typeof c=="function"||t.isPresent?a.cloneElement(r,{ref:s}):null};P.displayName="Presence";function b(e){const[o,c]=a.useState(),t=a.useRef({}),r=a.useRef(e),s=a.useRef("none"),m=e?"mounted":"unmounted",[d,i]=E(m,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return a.useEffect(()=>{const n=N(t.current);s.current=d==="mounted"?n:"none"},[d]),p(()=>{const n=t.current,f=r.current;if(f!==e){const $=s.current,l=N(n);e?i("MOUNT"):l==="none"||(n==null?void 0:n.display)==="none"?i("UNMOUNT"):i(f&&$!==l?"ANIMATION_OUT":"UNMOUNT"),r.current=e}},[e,i]),p(()=>{if(o){const n=u=>{const l=N(t.current).includes(u.animationName);u.target===o&&l&&A.flushSync(()=>i("ANIMATION_END"))},f=u=>{u.target===o&&(s.current=N(t.current))};return o.addEventListener("animationstart",f),o.addEventListener("animationcancel",n),o.addEventListener("animationend",n),()=>{o.removeEventListener("animationstart",f),o.removeEventListener("animationcancel",n),o.removeEventListener("animationend",n)}}else i("ANIMATION_END")},[o,i]),{isPresent:["mounted","unmountSuspended"].includes(d),ref:a.useCallback(n=>{n&&(t.current=getComputedStyle(n)),c(n)},[])}}function N(e){return(e==null?void 0:e.animationName)||"none"}function C({prop:e,defaultProp:o,onChange:c=()=>{}}){const[t,r]=M({defaultProp:o,onChange:c}),s=e!==void 0,m=s?e:t,d=v(c),i=a.useCallback(n=>{if(s){const u=typeof n=="function"?n(e):n;u!==e&&d(u)}else r(n)},[s,e,r,d]);return[m,i]}function M({defaultProp:e,onChange:o}){const c=a.useState(e),[t]=c,r=a.useRef(t),s=v(o);return a.useEffect(()=>{r.current!==t&&(s(t),r.current=t)},[t,r,s]),c}export{C as $,P as a};
//# sourceMappingURL=index-1da7f642.js.map
