import{j as g}from"./jsx-runtime-ffb262ed.js";import{$ as D,a as H,b as q,c as B,_ as T,d as K,e as Y}from"./index-e7410152.js";import{r}from"./index-76fb7be0.js";import{$ as G,a as X,b as z,c as W,d as y,e as J,f as Q,g as Z,h as ee,i as te}from"./index-317d39fe.js";import{r as ne}from"./index-d3ea75b5.js";function oe(e,n){return r.useReducer((t,o)=>{const a=n[t][o];return a??t},e)}const M=e=>{const{present:n,children:t}=e,o=re(n),a=typeof t=="function"?t({present:o.isPresent}):r.Children.only(t),c=D(o.ref,a.ref);return typeof t=="function"||o.isPresent?r.cloneElement(a,{ref:c}):null};M.displayName="Presence";function re(e){const[n,t]=r.useState(),o=r.useRef({}),a=r.useRef(e),c=r.useRef("none"),l=e?"mounted":"unmounted",[f,s]=oe(l,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return r.useEffect(()=>{const i=O(o.current);c.current=f==="mounted"?i:"none"},[f]),H(()=>{const i=o.current,u=a.current;if(u!==e){const $=c.current,p=O(i);e?s("MOUNT"):p==="none"||(i==null?void 0:i.display)==="none"?s("UNMOUNT"):s(u&&$!==p?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,s]),H(()=>{if(n){const i=d=>{const p=O(o.current).includes(d.animationName);d.target===n&&p&&ne.flushSync(()=>s("ANIMATION_END"))},u=d=>{d.target===n&&(c.current=O(o.current))};return n.addEventListener("animationstart",u),n.addEventListener("animationcancel",i),n.addEventListener("animationend",i),()=>{n.removeEventListener("animationstart",u),n.removeEventListener("animationcancel",i),n.removeEventListener("animationend",i)}}else s("ANIMATION_END")},[n,s]),{isPresent:["mounted","unmountSuspended"].includes(f),ref:r.useCallback(i=>{i&&(o.current=getComputedStyle(i)),t(i)},[])}}function O(e){return(e==null?void 0:e.animationName)||"none"}function ae({prop:e,defaultProp:n,onChange:t=()=>{}}){const[o,a]=ce({defaultProp:n,onChange:t}),c=e!==void 0,l=c?e:o,f=q(t),s=r.useCallback(i=>{if(c){const d=typeof i=="function"?i(e):i;d!==e&&f(d)}else a(i)},[c,e,a,f]);return[l,s]}function ce({defaultProp:e,onChange:n}){const t=r.useState(e),[o]=t,a=r.useRef(o),c=q(n);return r.useEffect(()=>{a.current!==o&&(c(o),a.current=o)},[o,a,c]),t}const[N,qe]=B("Tooltip",[G]),R=G(),se="TooltipProvider",ie=700,A="tooltip.open",[le,I]=N(se),ue=e=>{const{__scopeTooltip:n,delayDuration:t=ie,skipDelayDuration:o=300,disableHoverableContent:a=!1,children:c}=e,[l,f]=r.useState(!0),s=r.useRef(!1),i=r.useRef(0);return r.useEffect(()=>{const u=i.current;return()=>window.clearTimeout(u)},[]),r.createElement(le,{scope:n,isOpenDelayed:l,delayDuration:t,onOpen:r.useCallback(()=>{window.clearTimeout(i.current),f(!1)},[]),onClose:r.useCallback(()=>{window.clearTimeout(i.current),i.current=window.setTimeout(()=>f(!0),o)},[o]),isPointerInTransitRef:s,onPointerInTransitChange:r.useCallback(u=>{s.current=u},[]),disableHoverableContent:a},c)},L="Tooltip",[de,w]=N(L),fe=e=>{const{__scopeTooltip:n,children:t,open:o,defaultOpen:a=!1,onOpenChange:c,disableHoverableContent:l,delayDuration:f}=e,s=I(L,e.__scopeTooltip),i=R(n),[u,d]=r.useState(null),$=X(),p=r.useRef(0),m=l??s.disableHoverableContent,b=f??s.delayDuration,v=r.useRef(!1),[x=!1,h]=ae({prop:o,defaultProp:a,onChange:S=>{S?(s.onOpen(),document.dispatchEvent(new CustomEvent(A))):s.onClose(),c==null||c(S)}}),C=r.useMemo(()=>x?v.current?"delayed-open":"instant-open":"closed",[x]),E=r.useCallback(()=>{window.clearTimeout(p.current),v.current=!1,h(!0)},[h]),P=r.useCallback(()=>{window.clearTimeout(p.current),h(!1)},[h]),k=r.useCallback(()=>{window.clearTimeout(p.current),p.current=window.setTimeout(()=>{v.current=!0,h(!0)},b)},[b,h]);return r.useEffect(()=>()=>window.clearTimeout(p.current),[]),r.createElement(z,i,r.createElement(de,{scope:n,contentId:$,open:x,stateAttribute:C,trigger:u,onTriggerChange:d,onTriggerEnter:r.useCallback(()=>{s.isOpenDelayed?k():E()},[s.isOpenDelayed,k,E]),onTriggerLeave:r.useCallback(()=>{m?P():window.clearTimeout(p.current)},[P,m]),onOpen:E,onClose:P,disableHoverableContent:m},t))},U="TooltipTrigger",pe=r.forwardRef((e,n)=>{const{__scopeTooltip:t,...o}=e,a=w(U,t),c=I(U,t),l=R(t),f=r.useRef(null),s=D(n,f,a.onTriggerChange),i=r.useRef(!1),u=r.useRef(!1),d=r.useCallback(()=>i.current=!1,[]);return r.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),r.createElement(W,T({asChild:!0},l),r.createElement(K.button,T({"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute},o,{ref:s,onPointerMove:y(e.onPointerMove,$=>{$.pointerType!=="touch"&&!u.current&&!c.isPointerInTransitRef.current&&(a.onTriggerEnter(),u.current=!0)}),onPointerLeave:y(e.onPointerLeave,()=>{a.onTriggerLeave(),u.current=!1}),onPointerDown:y(e.onPointerDown,()=>{i.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:y(e.onFocus,()=>{i.current||a.onOpen()}),onBlur:y(e.onBlur,a.onClose),onClick:y(e.onClick,a.onClose)})))}),V="TooltipPortal",[$e,me]=N(V,{forceMount:void 0}),ve=e=>{const{__scopeTooltip:n,forceMount:t,children:o,container:a}=e,c=w(V,n);return r.createElement($e,{scope:n,forceMount:t},r.createElement(M,{present:t||c.open},r.createElement(J,{asChild:!0,container:a},o)))},_="TooltipContent",be=r.forwardRef((e,n)=>{const t=me(_,e.__scopeTooltip),{forceMount:o=t.forceMount,side:a="top",...c}=e,l=w(_,e.__scopeTooltip);return r.createElement(M,{present:o||l.open},l.disableHoverableContent?r.createElement(F,T({side:a},c,{ref:n})):r.createElement(he,T({side:a},c,{ref:n})))}),he=r.forwardRef((e,n)=>{const t=w(_,e.__scopeTooltip),o=I(_,e.__scopeTooltip),a=r.useRef(null),c=D(n,a),[l,f]=r.useState(null),{trigger:s,onClose:i}=t,u=a.current,{onPointerInTransitChange:d}=o,$=r.useCallback(()=>{f(null),d(!1)},[d]),p=r.useCallback((m,b)=>{const v=m.currentTarget,x={x:m.clientX,y:m.clientY},h=Ce(x,v.getBoundingClientRect()),C=Ee(x,h),E=Pe(b.getBoundingClientRect()),P=we([...C,...E]);f(P),d(!0)},[d]);return r.useEffect(()=>()=>$(),[$]),r.useEffect(()=>{if(s&&u){const m=v=>p(v,u),b=v=>p(v,s);return s.addEventListener("pointerleave",m),u.addEventListener("pointerleave",b),()=>{s.removeEventListener("pointerleave",m),u.removeEventListener("pointerleave",b)}}},[s,u,p,$]),r.useEffect(()=>{if(l){const m=b=>{const v=b.target,x={x:b.clientX,y:b.clientY},h=(s==null?void 0:s.contains(v))||(u==null?void 0:u.contains(v)),C=!_e(x,l);h?$():C&&($(),i())};return document.addEventListener("pointermove",m),()=>document.removeEventListener("pointermove",m)}},[s,u,l,i,$]),r.createElement(F,T({},e,{ref:c}))}),[xe,Te]=N(L,{isInside:!1}),F=r.forwardRef((e,n)=>{const{__scopeTooltip:t,children:o,"aria-label":a,onEscapeKeyDown:c,onPointerDownOutside:l,...f}=e,s=w(_,t),i=R(t),{onClose:u}=s;return r.useEffect(()=>(document.addEventListener(A,u),()=>document.removeEventListener(A,u)),[u]),r.useEffect(()=>{if(s.trigger){const d=$=>{const p=$.target;p!=null&&p.contains(s.trigger)&&u()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[s.trigger,u]),r.createElement(Q,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:c,onPointerDownOutside:l,onFocusOutside:d=>d.preventDefault(),onDismiss:u},r.createElement(Z,T({"data-state":s.stateAttribute},i,f,{ref:n,style:{...f.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"}}),r.createElement(Y,null,o),r.createElement(xe,{scope:t,isInside:!0},r.createElement(ee,{id:s.contentId,role:"tooltip"},a||o))))}),ge="TooltipArrow",ye=r.forwardRef((e,n)=>{const{__scopeTooltip:t,...o}=e,a=R(t);return Te(ge,t).isInside?null:r.createElement(te,T({},a,o,{ref:n}))});function Ce(e,n){const t=Math.abs(n.top-e.y),o=Math.abs(n.bottom-e.y),a=Math.abs(n.right-e.x),c=Math.abs(n.left-e.x);switch(Math.min(t,o,a,c)){case c:return"left";case a:return"right";case t:return"top";case o:return"bottom";default:throw new Error("unreachable")}}function Ee(e,n,t=5){const o=[];switch(n){case"top":o.push({x:e.x-t,y:e.y+t},{x:e.x+t,y:e.y+t});break;case"bottom":o.push({x:e.x-t,y:e.y-t},{x:e.x+t,y:e.y-t});break;case"left":o.push({x:e.x+t,y:e.y-t},{x:e.x+t,y:e.y+t});break;case"right":o.push({x:e.x-t,y:e.y-t},{x:e.x-t,y:e.y+t});break}return o}function Pe(e){const{top:n,right:t,bottom:o,left:a}=e;return[{x:a,y:n},{x:t,y:n},{x:t,y:o},{x:a,y:o}]}function _e(e,n){const{x:t,y:o}=e;let a=!1;for(let c=0,l=n.length-1;c<n.length;l=c++){const f=n[c].x,s=n[c].y,i=n[l].x,u=n[l].y;s>o!=u>o&&t<(i-f)*(o-s)/(u-s)+f&&(a=!a)}return a}function we(e){const n=e.slice();return n.sort((t,o)=>t.x<o.x?-1:t.x>o.x?1:t.y<o.y?-1:t.y>o.y?1:0),Oe(n)}function Oe(e){if(e.length<=1)return e.slice();const n=[];for(let o=0;o<e.length;o++){const a=e[o];for(;n.length>=2;){const c=n[n.length-1],l=n[n.length-2];if((c.x-l.x)*(a.y-l.y)>=(c.y-l.y)*(a.x-l.x))n.pop();else break}n.push(a)}n.pop();const t=[];for(let o=e.length-1;o>=0;o--){const a=e[o];for(;t.length>=2;){const c=t[t.length-1],l=t[t.length-2];if((c.x-l.x)*(a.y-l.y)>=(c.y-l.y)*(a.x-l.x))t.pop();else break}t.push(a)}return t.pop(),n.length===1&&t.length===1&&n[0].x===t[0].x&&n[0].y===t[0].y?n:n.concat(t)}const Ne=ue,Re=fe,Ae=pe,De=ve,Me=be,Ie=ye;var Le="la997z0";const j=({children:e,content:n,side:t="top",align:o="center",options:a,rootOptions:c,portalOptions:l})=>g.jsx(Ne,{children:g.jsxs(Re,{delayDuration:500,...c,children:[g.jsx(Ae,{asChild:!0,children:e}),g.jsx(De,{...l,children:g.jsxs(Me,{className:Le,side:t,align:o,sideOffset:5,...a,children:[n,g.jsx(Ie,{height:6,width:10,fill:"var(--affine-tooltip)"})]})})]})});try{j.displayName="Tooltip",j.__docgenInfo={description:"",displayName:"Tooltip",props:{content:{defaultValue:null,description:"",name:"content",required:!0,type:{name:"ReactNode"}},side:{defaultValue:{value:"top"},description:"",name:"side",required:!1,type:{name:"enum",value:[{value:'"top"'},{value:'"right"'},{value:'"bottom"'},{value:'"left"'}]}},align:{defaultValue:{value:"center"},description:"",name:"align",required:!1,type:{name:"enum",value:[{value:'"start"'},{value:'"end"'},{value:'"center"'}]}},rootOptions:{defaultValue:null,description:"",name:"rootOptions",required:!1,type:{name:'Omit<TooltipProps, "children">'}},portalOptions:{defaultValue:null,description:"",name:"portalOptions",required:!1,type:{name:"TooltipPortalProps"}},options:{defaultValue:null,description:"",name:"options",required:!1,type:{name:'Omit<TooltipContentProps, "side" | "align">'}}}}}catch{}export{ae as $,j as T,M as a};
//# sourceMappingURL=tooltip-54f8f17e.js.map
