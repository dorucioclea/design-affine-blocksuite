import{j as i}from"./jsx-runtime-ffb262ed.js";import{B as N}from"./button-13f3ee9c.js";import"./icon-button-1fb8b8e2.js";import{$ as T,f as j,a as R,c as k,_ as l,g as P,h as S,b as K,i as V}from"./index-249b4978.js";import{r as e}from"./index-76fb7be0.js";import{h as q,$ as z,a as B,b as G}from"./Combination-f8aa56ae.js";import{$ as A,a as L,b as U,c as H}from"./index-20c503a8.js";import{$ as Z,a as F}from"./index-46d22cb5.js";import{c as J}from"./clsx-1229b3e0.js";import"./style.css-8d70dfc7.js";import"./vanilla-extract-dynamic.esm-c334c93f.js";import"./index-d3ea75b5.js";import"./_commonjsHelpers-de833af9.js";const w="Popover",[y,Ee]=T(w,[A]),O=A(),[Q,$]=y(w),W=o=>{const{__scopePopover:p,children:a,open:s,defaultOpen:r,onOpenChange:t,modal:c=!1}=o,n=O(p),d=e.useRef(null),[u,g]=e.useState(!1),[x=!1,f]=Z({prop:s,defaultProp:r,onChange:t});return e.createElement(L,n,e.createElement(Q,{scope:p,contentId:j(),triggerRef:d,open:x,onOpenChange:f,onOpenToggle:e.useCallback(()=>f(h=>!h),[f]),hasCustomAnchor:u,onCustomAnchorAdd:e.useCallback(()=>g(!0),[]),onCustomAnchorRemove:e.useCallback(()=>g(!1),[]),modal:c},a))},X="PopoverTrigger",Y=e.forwardRef((o,p)=>{const{__scopePopover:a,...s}=o,r=$(X,a),t=O(a),c=R(p,r.triggerRef),n=e.createElement(k.button,l({type:"button","aria-haspopup":"dialog","aria-expanded":r.open,"aria-controls":r.contentId,"data-state":M(r.open)},s,{ref:c,onClick:P(o.onClick,r.onOpenToggle)}));return r.hasCustomAnchor?n:e.createElement(U,l({asChild:!0},t),n)}),D="PopoverPortal",[ee,oe]=y(D,{forceMount:void 0}),te=o=>{const{__scopePopover:p,forceMount:a,children:s,container:r}=o,t=$(D,p);return e.createElement(ee,{scope:p,forceMount:a},e.createElement(F,{present:a||t.open},e.createElement(S,{asChild:!0,container:r},s)))},v="PopoverContent",ce=e.forwardRef((o,p)=>{const a=oe(v,o.__scopePopover),{forceMount:s=a.forceMount,...r}=o,t=$(v,o.__scopePopover);return e.createElement(F,{present:s||t.open},t.modal?e.createElement(re,l({},r,{ref:p})):e.createElement(ne,l({},r,{ref:p})))}),re=e.forwardRef((o,p)=>{const a=$(v,o.__scopePopover),s=e.useRef(null),r=R(p,s),t=e.useRef(!1);return e.useEffect(()=>{const c=s.current;if(c)return q(c)},[]),e.createElement(z,{as:K,allowPinchZoom:!0},e.createElement(I,l({},o,{ref:r,trapFocus:a.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:P(o.onCloseAutoFocus,c=>{var n;c.preventDefault(),t.current||(n=a.triggerRef.current)===null||n===void 0||n.focus()}),onPointerDownOutside:P(o.onPointerDownOutside,c=>{const n=c.detail.originalEvent,d=n.button===0&&n.ctrlKey===!0,u=n.button===2||d;t.current=u},{checkForDefaultPrevented:!1}),onFocusOutside:P(o.onFocusOutside,c=>c.preventDefault(),{checkForDefaultPrevented:!1})})))}),ne=e.forwardRef((o,p)=>{const a=$(v,o.__scopePopover),s=e.useRef(!1),r=e.useRef(!1);return e.createElement(I,l({},o,{ref:p,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{var c;if((c=o.onCloseAutoFocus)===null||c===void 0||c.call(o,t),!t.defaultPrevented){var n;s.current||(n=a.triggerRef.current)===null||n===void 0||n.focus(),t.preventDefault()}s.current=!1,r.current=!1},onInteractOutside:t=>{var c,n;(c=o.onInteractOutside)===null||c===void 0||c.call(o,t),t.defaultPrevented||(s.current=!0,t.detail.originalEvent.type==="pointerdown"&&(r.current=!0));const d=t.target;((n=a.triggerRef.current)===null||n===void 0?void 0:n.contains(d))&&t.preventDefault(),t.detail.originalEvent.type==="focusin"&&r.current&&t.preventDefault()}}))}),I=e.forwardRef((o,p)=>{const{__scopePopover:a,trapFocus:s,onOpenAutoFocus:r,onCloseAutoFocus:t,disableOutsidePointerEvents:c,onEscapeKeyDown:n,onPointerDownOutside:d,onFocusOutside:u,onInteractOutside:g,...x}=o,f=$(v,a),h=O(a);return B(),e.createElement(G,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:r,onUnmountAutoFocus:t},e.createElement(V,{asChild:!0,disableOutsidePointerEvents:c,onInteractOutside:g,onEscapeKeyDown:n,onPointerDownOutside:d,onFocusOutside:u,onDismiss:()=>f.onOpenChange(!1)},e.createElement(H,l({"data-state":M(f.open),role:"dialog",id:f.contentId},h,x,{ref:p,style:{...x.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}}))))});function M(o){return o?"open":"closed"}const ae=W,se=Y,pe=te,ie=ce;var de="_101jbh0";const m=e.forwardRef(({content:o,children:p,portalOptions:a,contentOptions:{className:s,style:r,...t}={},...c})=>i.jsxs(ae,{...c,children:[i.jsx(se,{asChild:!0,children:p}),i.jsx(pe,{...a,children:i.jsx(ie,{className:e.useMemo(()=>J(de,s),[s]),sideOffset:5,align:"start",style:{zIndex:"var(--affine-z-index-popover)",...r},...t,children:o})})]}));m.displayName="Popover";try{m.displayName="Popover",m.__docgenInfo={description:"",displayName:"Popover",props:{content:{defaultValue:null,description:"",name:"content",required:!1,type:{name:"ReactNode"}},portalOptions:{defaultValue:null,description:"",name:"portalOptions",required:!1,type:{name:"PopoverPortalProps"}},contentOptions:{defaultValue:null,description:"",name:"contentOptions",required:!1,type:{name:"PopoverContentProps"}}}}}catch{}const Re={title:"UI/Popover",component:m},fe=o=>i.jsx(i.Fragment,{children:i.jsx(m,{content:i.jsx("div",{children:"111222"}),...o,children:i.jsx(N,{children:"Click to open popover"})})}),b=fe.bind(void 0);b.args={};var _,C,E;b.parameters={...b.parameters,docs:{...(_=b.parameters)==null?void 0:_.docs,source:{originalSource:"Template.bind(undefined)",...(E=(C=b.parameters)==null?void 0:C.docs)==null?void 0:E.source}}};const Ae=["DefaultAvatar"];export{b as DefaultAvatar,Ae as __namedExportsOrder,Re as default};
//# sourceMappingURL=popover.stories-bb580e12.js.map
