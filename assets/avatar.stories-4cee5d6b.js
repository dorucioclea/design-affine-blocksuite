import{j as d}from"./jsx-runtime-ffb262ed.js";import{c as C,a as U,i as G}from"./clsx-f09530c1.js";import{_ as p}from"./extends-98964cd2.js";import{r as t}from"./index-76fb7be0.js";import"./index-d3ea75b5.js";import"./_commonjsHelpers-de833af9.js";function J(e,o=[]){let a=[];function r(c,s){const l=t.createContext(s),i=a.length;a=[...a,s];function u(v){const{scope:f,children:x,...b}=v,O=(f==null?void 0:f[e][i])||l,W=t.useMemo(()=>b,Object.values(b));return t.createElement(O.Provider,{value:W},x)}function m(v,f){const x=(f==null?void 0:f[e][i])||l,b=t.useContext(x);if(b)return b;if(s!==void 0)return s;throw new Error(`\`${v}\` must be used within \`${c}\``)}return u.displayName=c+"Provider",[u,m]}const n=()=>{const c=a.map(s=>t.createContext(s));return function(l){const i=(l==null?void 0:l[e])||c;return t.useMemo(()=>({[`__scope${e}`]:{...l,[e]:i}}),[l,i])}};return n.scopeName=e,[r,K(n,...o)]}function K(...e){const o=e[0];if(e.length===1)return o;const a=()=>{const r=e.map(n=>({useScope:n(),scopeName:n.scopeName}));return function(c){const s=r.reduce((l,{useScope:i,scopeName:u})=>{const v=i(c)[`__scope${u}`];return{...l,...v}},{});return t.useMemo(()=>({[`__scope${o.scopeName}`]:s}),[s])}};return a.scopeName=o.scopeName,a}function X(e){const o=t.useRef(e);return t.useEffect(()=>{o.current=e}),t.useMemo(()=>(...a)=>{var r;return(r=o.current)===null||r===void 0?void 0:r.call(o,...a)},[])}const Z=globalThis!=null&&globalThis.document?t.useLayoutEffect:()=>{};function Q(e,o){typeof e=="function"?e(o):e!=null&&(e.current=o)}function Y(...e){return o=>e.forEach(a=>Q(a,o))}const B=t.forwardRef((e,o)=>{const{children:a,...r}=e,n=t.Children.toArray(a),c=n.find(te);if(c){const s=c.props.children,l=n.map(i=>i===c?t.Children.count(s)>1?t.Children.only(null):t.isValidElement(s)?s.props.children:null:i);return t.createElement(A,p({},r,{ref:o}),t.isValidElement(s)?t.cloneElement(s,void 0,l):null)}return t.createElement(A,p({},r,{ref:o}),a)});B.displayName="Slot";const A=t.forwardRef((e,o)=>{const{children:a,...r}=e;return t.isValidElement(a)?t.cloneElement(a,{...ae(r,a.props),ref:o?Y(o,a.ref):a.ref}):t.Children.count(a)>1?t.Children.only(null):null});A.displayName="SlotClone";const ee=({children:e})=>t.createElement(t.Fragment,null,e);function te(e){return t.isValidElement(e)&&e.type===ee}function ae(e,o){const a={...o};for(const r in o){const n=e[r],c=o[r];/^on[A-Z]/.test(r)?n&&c?a[r]=(...l)=>{c(...l),n(...l)}:n&&(a[r]=n):r==="style"?a[r]={...n,...c}:r==="className"&&(a[r]=[n,c].filter(Boolean).join(" "))}return{...e,...a}}const re=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],S=re.reduce((e,o)=>{const a=t.forwardRef((r,n)=>{const{asChild:c,...s}=r,l=c?B:o;return t.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),t.createElement(l,p({},s,{ref:n}))});return a.displayName=`Primitive.${o}`,{...e,[o]:a}},{}),H="Avatar",[oe,Pe]=J(H),[ne,z]=oe(H),se=t.forwardRef((e,o)=>{const{__scopeAvatar:a,...r}=e,[n,c]=t.useState("idle");return t.createElement(ne,{scope:a,imageLoadingStatus:n,onImageLoadingStatusChange:c},t.createElement(S.span,p({},r,{ref:o})))}),ce="AvatarImage",le=t.forwardRef((e,o)=>{const{__scopeAvatar:a,src:r,onLoadingStatusChange:n=()=>{},...c}=e,s=z(ce,a),l=ue(r),i=X(u=>{n(u),s.onImageLoadingStatusChange(u)});return Z(()=>{l!=="idle"&&i(l)},[l,i]),l==="loaded"?t.createElement(S.img,p({},c,{ref:o,src:r})):null}),ie="AvatarFallback",de=t.forwardRef((e,o)=>{const{__scopeAvatar:a,delayMs:r,...n}=e,c=z(ie,a),[s,l]=t.useState(r===void 0);return t.useEffect(()=>{if(r!==void 0){const i=window.setTimeout(()=>l(!0),r);return()=>window.clearTimeout(i)}},[r]),s&&c.imageLoadingStatus!=="loaded"?t.createElement(S.span,p({},n,{ref:o})):null});function ue(e){const[o,a]=t.useState("idle");return t.useEffect(()=>{if(!e){a("error");return}let r=!0;const n=new window.Image,c=s=>()=>{r&&a(s)};return a("loading"),n.onload=c("loaded"),n.onerror=c("error"),n.src=e,()=>{r=!1}},[e]),o}const fe=se,pe=le,me=de;var ve="q1nf3j6",be="q1nf3j7",$e="q1nf3j3",ge="q1nf3j4",ye="q1nf3j5",Fe="q1nf3j8",he="q1nf3jb",_e="q1nf3ja",xe="q1nf3j9",Ce="var(--q1nf3j0)";const N=[["#FF0000","#FF00E5","#FFAE73"],["#FF5C00","#FFC700","#FFE073"],["#FFDA16","#FFFBA6","#FFBE73"],["#8CD317","#FCFF5C","#67CAE9"],["#28E19F","#89FFC6","#39A880"],["#35B7E0","#77FFCE","#5076FF"],["#3D39FF","#77BEFF","#3502FF"],["#BD08EB","#755FFF","#6967E4"]],E=({char:e})=>{const o=t.useMemo(()=>{const i=e.toUpperCase().charCodeAt(0);return N[i%N.length]},[e]),a=t.useRef(),[r,n,c]=o,[s,l]=t.useState(!1);return d.jsxs("div",{className:$e,onMouseEnter:()=>{a.current=setTimeout(()=>{l(!0)},300)},onMouseLeave:()=>{clearTimeout(a.current),l(!1)},children:[d.jsx("div",{className:Fe,style:{background:c}}),d.jsx("div",{className:C(ge,{[ye]:s}),style:{background:n}}),d.jsx("div",{className:C(ve,{[be]:s}),style:{background:r}})]})};try{E.displayName="ColorfulFallback",E.__docgenInfo={description:"",displayName:"ColorfulFallback",props:{char:{defaultValue:null,description:"",name:"char",required:!0,type:{name:"string"}}}}}catch{}try{colorfulfallback.displayName="colorfulfallback",colorfulfallback.__docgenInfo={description:"",displayName:"colorfulfallback",props:{char:{defaultValue:null,description:"",name:"char",required:!0,type:{name:"string"}}}}}catch{}const h=({size:e=20,style:o={},url:a,name:r,className:n,colorfulFallback:c=!1,hoverIcon:s,fallbackProps:l,imageProps:i,avatarProps:u})=>{const m=t.useMemo(()=>(r==null?void 0:r.slice(0,1))||"A",[r]);return d.jsxs(fe,{style:{...U({[Ce]:e?`${e}px`:"20px"}),...o},className:C(xe,n,{"with-hover":s}),...u,children:[d.jsx(pe,{className:_e,src:a,alt:r,...i}),d.jsx(me,{className:he,delayMs:600,...l,children:c?d.jsx(E,{char:m}):m}),s?d.jsx("div",{className:"hover-wrapper",children:s}):null]})};try{h.displayName="Avatar",h.__docgenInfo={description:"",displayName:"Avatar",props:{size:{defaultValue:{value:"20"},description:"",name:"size",required:!1,type:{name:"number"}},url:{defaultValue:null,description:"",name:"url",required:!1,type:{name:"string"}},name:{defaultValue:null,description:"",name:"name",required:!1,type:{name:"string"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}},colorfulFallback:{defaultValue:{value:"false"},description:"",name:"colorfulFallback",required:!1,type:{name:"boolean"}},hoverIcon:{defaultValue:null,description:"",name:"hoverIcon",required:!1,type:{name:"ReactElement<any, string | JSXElementConstructor<any>>"}},fallbackProps:{defaultValue:null,description:"",name:"fallbackProps",required:!1,type:{name:'Omit<AvatarFallbackProps, "className" | "style">'}},imageProps:{defaultValue:null,description:"",name:"imageProps",required:!1,type:{name:'Omit<AvatarImageProps, "src">'}},avatarProps:{defaultValue:null,description:"",name:"avatarProps",required:!1,type:{name:"AvatarProps"}}}}}catch{}const Ie={title:"UI/Avatar",component:h,argTypes:{onClick:()=>console.log("Click button")}},_=e=>d.jsx(h,{...e}),$=_.bind(void 0);$.args={name:"AFFiNE",url:"https://affine.pro/favicon-96.png",size:50};const g=_.bind(void 0);g.args={name:"AFFiNE",size:50};const y=_.bind(void 0);y.args={size:50,colorfulFallback:!0,name:"blocksuite"};const F=_.bind(void 0);F.args={size:50,colorfulFallback:!0,name:"With Hover",hoverIcon:d.jsx(G.CameraIcon,{})};var k,j,P;$.parameters={...$.parameters,docs:{...(k=$.parameters)==null?void 0:k.docs,source:{originalSource:"Template.bind(undefined)",...(P=(j=$.parameters)==null?void 0:j.docs)==null?void 0:P.source}}};var I,q,V;g.parameters={...g.parameters,docs:{...(I=g.parameters)==null?void 0:I.docs,source:{originalSource:"Template.bind(undefined)",...(V=(q=g.parameters)==null?void 0:q.docs)==null?void 0:V.source}}};var w,M,L;y.parameters={...y.parameters,docs:{...(w=y.parameters)==null?void 0:w.docs,source:{originalSource:"Template.bind(undefined)",...(L=(M=y.parameters)==null?void 0:M.docs)==null?void 0:L.source}}};var R,T,D;F.parameters={...F.parameters,docs:{...(R=F.parameters)==null?void 0:R.docs,source:{originalSource:"Template.bind(undefined)",...(D=(T=F.parameters)==null?void 0:T.docs)==null?void 0:D.source}}};const qe=["DefaultAvatar","Fallback","ColorfulFallback","WithHover"];export{y as ColorfulFallback,$ as DefaultAvatar,g as Fallback,F as WithHover,qe as __namedExportsOrder,Ie as default};
//# sourceMappingURL=avatar.stories-4cee5d6b.js.map
